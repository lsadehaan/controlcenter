<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('partials/head') %>
</head>
<body>
  <%- include('partials/nav') %>
  
  <main class="main-content">
    <div class="container">
      <h2>Settings</h2>
      
      <div class="settings-sections">
        <section class="settings-section">
          <h3>Registration Tokens</h3>
          <p>Generate tokens for new agent registration</p>
          <button class="btn btn-primary" id="generate-token-btn">Generate New Token</button>
          <div id="token-display" style="display: none; margin-top: 20px;">
            <p><strong>New Registration Token:</strong></p>
            <code id="token-value" style="background: #f5f5f5; padding: 10px; display: block; word-break: break-all;"></code>
            <p style="margin-top: 10px;">Valid for: <span id="token-expiry">1 hour</span></p>
            <p style="margin-top: 15px;"><strong>To register an agent, run:</strong></p>
            <code id="agent-command" style="background: #2d2d2d; color: #f8f8f2; padding: 10px; display: block; border-radius: 4px; font-size: 12px;"></code>
            <button class="btn btn-sm" style="margin-top: 10px;" id="copy-command-btn">Copy Command</button>
          </div>
        </section>

        <section class="settings-section">
          <h3>User Management</h3>
          <p>Manage user accounts and access</p>

          <div style="margin-bottom: 20px;">
            <button class="btn btn-primary" id="add-user-btn">Add New User</button>
          </div>

          <table class="data-table" id="users-table">
            <thead>
              <tr>
                <th>Username</th>
                <th>Role</th>
                <th>Created</th>
                <th>Last Login</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="users-list">
              <tr>
                <td colspan="5" style="text-align: center; padding: 20px;">Loading users...</td>
              </tr>
            </tbody>
          </table>
        </section>

        <section class="settings-section">
          <h3>Notification Settings</h3>
          <form id="notification-settings">
            <div class="form-group">
              <label>Email Notifications</label>
              <input type="email" placeholder="admin@example.com" class="form-input">
            </div>
            <div class="form-group">
              <label>Slack Webhook URL</label>
              <input type="url" placeholder="https://hooks.slack.com/services/..." class="form-input">
            </div>
            <div class="form-group">
              <label>Alert Levels to Notify</label>
              <div class="checkbox-group">
                <label><input type="checkbox" value="info"> Info</label>
                <label><input type="checkbox" value="warning" checked> Warning</label>
                <label><input type="checkbox" value="error" checked> Error</label>
                <label><input type="checkbox" value="critical" checked> Critical</label>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Save Notification Settings</button>
          </form>
        </section>
        
        <section class="settings-section">
          <h3>System Configuration</h3>
          <div class="config-info">
            <div class="config-row">
              <span class="config-label">Database Location:</span>
              <span class="config-value">./data/control-center.db</span>
            </div>
            <div class="config-row">
              <span class="config-label">WebSocket Port:</span>
              <span class="config-value">3000</span>
            </div>
            <div class="config-row">
              <span class="config-label">Agent Heartbeat Interval:</span>
              <span class="config-value">30 seconds</span>
            </div>
            <div class="config-row">
              <span class="config-label">Log Retention:</span>
              <span class="config-value">30 days</span>
            </div>
          </div>
        </section>
        
        <section class="settings-section">
          <h3>Maintenance</h3>
          <button class="btn" id="clear-logs-btn">Clear Old Logs</button>
          <button class="btn" id="export-db-btn">Export Database</button>
          <button class="btn btn-danger" id="reset-system-btn">Reset System</button>
        </section>

        <section class="settings-section">
          <h3>About</h3>
          <div class="config-info">
            <div class="config-row">
              <span class="config-label">Manager Version:</span>
              <span class="config-value"><%= version || 'Unknown' %></span>
            </div>
            <div class="config-row">
              <span class="config-label">License:</span>
              <span class="config-value">AGPL-3.0</span>
            </div>
            <div class="config-row">
              <span class="config-label">Project:</span>
              <span class="config-value"><a href="https://github.com/lsadehaan/controlcenter" target="_blank" style="color: #4a90e2;">Control Center on GitHub</a></span>
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>
  
  <%- include('partials/footer') %>

  <script src="/js/settings.js"></script>
</body>
</html>