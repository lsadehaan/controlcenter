<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('partials/head') %>
  <link rel="stylesheet" href="/vendor/drawflow/drawflow.min.css">
  <link rel="stylesheet" href="/css/workflow-editor.css">
</head>
<body data-workflow='<%- workflow ? JSON.stringify(workflow) : "null" %>'>
  <%- include('partials/nav') %>

  <main class="main-content">
    <div class="container-fluid">
      <div class="editor-header">
        <h2>Workflow Editor</h2>
        <div class="editor-controls">
          <input type="text" id="workflow-name" placeholder="Workflow Name" class="form-input">
          <button id="save-workflow-btn" class="btn btn-primary">Save Workflow</button>
          <button id="clear-workflow-btn" class="btn">Clear</button>
          <button id="export-workflow-btn" class="btn">Export</button>
          <button id="import-workflow-btn" class="btn">Import</button>
          <div style="border-left: 1px solid #dee2e6; margin: 0 10px; height: 24px; display: inline-block;"></div>
          <button id="zoom-in-btn" class="btn btn-sm" title="Zoom In">â•</button>
          <button id="zoom-out-btn" class="btn btn-sm" title="Zoom Out">â–</button>
          <button id="zoom-reset-btn" class="btn btn-sm" title="Reset Zoom">ğŸ”„</button>
          <button id="zoom-to-fit-btn" class="btn btn-sm" title="Fit to Screen">â¬œ</button>
        </div>
      </div>

      <div class="editor-layout">
        <div class="node-palette">
          <h3>Triggers</h3>
          <div class="palette-item" draggable="true" data-node="file-trigger">
            <i class="icon">ğŸ“</i> File Trigger
          </div>
          <div class="palette-item" draggable="true" data-node="filewatcher-trigger">
            <i class="icon">ğŸ‘ï¸</i> File Watcher Trigger
          </div>
          <div class="palette-item" draggable="true" data-node="schedule-trigger">
            <i class="icon">â°</i> Schedule Trigger
          </div>
          <div class="palette-item" draggable="true" data-node="webhook-trigger">
            <i class="icon">ğŸŒ</i> Webhook Trigger
          </div>

          <h3>File Operations</h3>
          <div class="palette-item" draggable="true" data-node="move-file">
            <i class="icon">ğŸ“‹</i> Move File
          </div>
          <div class="palette-item" draggable="true" data-node="copy-file">
            <i class="icon">ğŸ“„</i> Copy File
          </div>
          <div class="palette-item" draggable="true" data-node="delete-file">
            <i class="icon">ğŸ—‘ï¸</i> Delete File
          </div>

          <h3>System Actions</h3>
          <div class="palette-item" draggable="true" data-node="run-command">
            <i class="icon">ğŸ’»</i> Run Command
          </div>

          <h3>Cloud Services</h3>
          <div class="palette-item" draggable="true" data-node="s3-upload">
            <i class="icon">â˜ï¸</i> S3 Upload
          </div>

          <h3>Platform</h3>
          <div class="palette-item" draggable="true" data-node="alert">
            <i class="icon">ğŸ””</i> Send Alert
          </div>
        </div>

        <div id="drawflow">
          <div class="nav-hint">Shift+Drag to pan â€¢ Ctrl+Scroll to zoom â€¢ Middle-click to pan</div>
        </div>

        <div class="splitter" id="splitter"></div>

        <div class="properties-panel" id="properties-panel">
          <div id="properties-content" style="height: 100%; padding: 15px;">
            <p class="no-selection" style="text-align: center; color: #6c757d; margin-top: 50px;">Select a node to edit properties</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script src="/vendor/drawflow/drawflow.min.js"></script>
  <script src="/js/workflow-editor.js"></script>
</body>
</html>
